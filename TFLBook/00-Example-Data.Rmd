# Example Data
## twoCmt
Example dataset '0069.csv' contains a NONMEM input datafile merged with output from a population PK analysis. 
Dosing records have been removed for this example.  The input datafile was derived from a single-dose, parallel group, dose-escalation study with intravenous and subcutaneous routes of administration.  PK samples were collected extensively following dosing in 108 subjects who were healthy or had disease status 1 or 2 (DISF).  Basic patient-specific demographics are included in the dataset such as Age (AGE), Weight (WGTB), Height (HGTB), and Race (RACE).

### Data

```{r echo=TRUE}
library(dplyr)
tab=read.table(file.path(find.package('TFL'),'external/0069/0069.tab'),
               header=TRUE, skip=1, stringsAsFactors=F, fill=TRUE)
tab <- subset(tab, select=c(ID:HGTB,MDV))
tab <- group_by(tab, ID,TIME,STUD,EVID)
tab <- mutate(tab, WGT=WGTB+.1*TIME+rnorm(length(WGTB)))
tab$WGT[ tab$STUD==183 ] <- NA
```

```{r echo=FALSE}
DT::datatable(tab,
              extensions = c('Scroller','FixedColumns'), 
              options = list(
                              deferRender = TRUE,
                              pageLength=nrow(tab),
                              scrollY = 400,
                              scroller = TRUE,
                              dom = 't',
                              scrollX = TRUE,
                              fixedColumns = TRUE
                            )
              )
```


### Control Stream Description
NONMEM output is also included in the dataset including population and individual predicted concentrations (PRED and IPRED), residual and weighted residual values (RES and WRES), normalized predicted distribution errors (NPDE), individual post-hoc estimates of all inter-individual variability estimates (ETA's) as well as individual estimates of all PK parameters.

The population PK model which described the data was a 2-compartment model following oral and intravenous drug administration.  The model included estimates of inter-individual variability for CL and V2 with an estimate of covariance between these parameters. Inter-individual variability was also estimated on KA.  Additive and proportional residual variability were also estimated in the model.

The parameter table rendered in [RNM] provides parameter labels, units, typical value estimates, and estimates of relative standard error (RSE) and confidence intervals (CI) for the typical values, for all parameters included in the final model.  It should be noted that parameter labels must be included in the original run control stream to be retrieved from the xml file used to generate the final table output.  

Control stream formating rules for variance components:

  - [P] yields CV
  - [A] yields sd
  - [F] yields r as appropriate

Example: 

```
$THETA 
  (.001,.08,2) ; [L/day] CL
  (7,18,40) ; [L] V

$OMEGA BLOCK(2) 
  .6 ;[P] CL 
  .3 ;[F] CL-V
  .3 ;[A] V
```

Will give:

  - titles of “CL” and “V” with units of “L/day” and “L” for THETA
  - For variance components, the titles are “CL”, “CL-V”, and “V”.  CL will report the CV, the off-diagonal will report as correlation, and the IIV for F will be reported as a standard deviation
  - Similar rules apply to residual error

RSE and CI are calculated using ... (provide eq'n if using NONMEM output)

**Full Control Stream**
```{r results='asis',echo=FALSE}
cat(ctl2html(file.path(find.package('TFL'),'external/0069/0069.ctl')),file=file.path(hlp.dir,'twoCmtCTL.html'),sep='\n')
writeLines(paste0('<iframe width="100%" height="400" src="',file.path(hlp.dir,'twoCmtCTL.html'),'" allowfullscreen></iframe>'))
```

## mi210

### Data
```{r eval=FALSE,echo=TRUE}
library(dplyr)
tab =file.path(find.package('TFL'),'external/mi210/510/510.tab')
demog = file.path(find.package('TFL'),'external/mi210/poppk_wcovs.csv')
mi210<-demog%>%left_join(tab,by=c("ID","DV","TIME"))
mi210$Run='510'
mi210$med <- median(mi210$CLCR[!duplicated(mi210$ID)])
mi210$CLCRF <- mi210$CLCR <= mi210$med
mi210$CLCRF <- factor(mi210$CLCRF, levels=c(FALSE, TRUE), labels=c("<= med", "> med"))
mi210$med <- NULL
mi210$STUDY <- "Study 1"
```

```{r echo=FALSE}
DT::datatable(mi210,
              extensions = c('Scroller','FixedColumns'), 
              options = list(
                              deferRender = TRUE,
                              pageLength=nrow(tab),
                              scrollY = 400,
                              scroller = TRUE,
                              dom = 't',
                              scrollX = TRUE,
                              fixedColumns = TRUE
                            )
              )
```


### Control Stream Description
NONMEM output is also included in the dataset including population and individual predicted concentrations (PRED and IPRED), residual and weighted residual values (RES and WRES), normalized predicted distribution errors (NPDE), individual post-hoc estimates of all inter-individual variability estimates (ETA's) as well as individual estimates of all PK parameters.

Control stream formating rules for variance components:

  - [P] yields CV
  - [A] yields sd
  - [F] yields r as appropriate

Example: 

```
$THETA 
  (.001,.08,2) ; [L/day] CL
  (7,18,40) ; [L] V

$OMEGA BLOCK(2) 
  .6 ;[P] CL 
  .3 ;[F] CL-V
  .3 ;[A] V
```

Will give:

  - titles of “CL” and “V” with units of “L/day” and “L” for THETA
  - For variance components, the titles are “CL”, “CL-V”, and “V”.  CL will report the CV, the off-diagonal will report as correlation, and the IIV for F will be reported as a standard deviation
  - Similar rules apply to residual error

RSE and CI are calculated using ... (provide eq'n if using NONMEM output)

**Full Control Stream**
```{r results='asis',echo=FALSE}
cat(ctl2html(file.path(find.package('TFL'),'external/mi210/510/510.ctl')),file=file.path(hlp.dir,'mi210CTL.html'),sep='\n')
writeLines(paste0('<iframe width="100%" height="400" src="',file.path(hlp.dir,'mi210CTL.html'),'" allowfullscreen></iframe>'))
```